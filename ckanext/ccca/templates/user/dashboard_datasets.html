{% extends "user/dashboard.html" %}

{% block dashboard_activity_stream_context %}{% endblock %}

{% block page_primary_action %}
  {% if h.check_access('package_create') %}
    {% link_for _('Add Dataset'), controller='package', action='new', class_="btn btn-primary", icon="plus-sign-alt" %}
  {% endif %}
{% endblock %}

{% block primary_content_inner %}

{% set creator_sets = h.ccca_check_user_datasets(c.user_dict.datasets, c.user)%}
{% set author_sets = h.ccca_get_dataset_by_role('author', c.user)%}
{% set maintainer_sets = h.ccca_get_dataset_by_role('maintainer', c.user)%}

  <h2 class="hide-heading">{{ _('My Datasets') }}</h2>
  {% if not creator_sets and not author_sets and not maintainer_sets %}
      <p class="empty">
      {{ _('You haven\'t created any datasets.') }}
      {% if h.check_access('package_create') %}
        {% link_for _('Create one now?'), controller='package', action='new' %}
      {% endif %}
    </p>
  {% else %}
  <div id="accordion" role="tablist">
    {% if creator_sets %}
    <div class="card">
      <div class="card-header" role="tab" id="headingOne">
        <div class="row">
        <h3>
         <div class="col-sm-7 col-xs-7">
          <a data-toggle="collapse" href="#collapse1" aria-expanded="true" aria-controls="collapse1">
            {{ _('Creator') }}
              <i class="icon-angle-down pull-right"></i>
          </a>
         </div>
       </h3>
        </div>
      </div>
      <div id="collapse1" class="collapse" role="tabpanel" aria-labelledby="heading1" data-parent="#accordion">
        <div class="card-body">
          <hr>
          {% snippet 'snippets/package_list.html', packages=creator_sets %}
        </div>
      </div>
    </div> {#} Card {#}
    {% endif %}

    {% if author_sets %}
    <div class="card">
      <div class="card-header" role="tab" id="headingOne">
        <div class="row">
        <h3>
         <div class="col-sm-7 col-xs-7">
          <a data-toggle="collapse" href="#collapse2" aria-expanded="true" aria-controls="collapse2">
            {{ _('Author') }}
              <i class="icon-angle-down pull-right"></i>
          </a>
         </div>
       </h3>
        </div>
      </div>
      <div id="collapse2" class="collapse" role="tabpanel" aria-labelledby="heading1" data-parent="#accordion">
        <div class="card-body">
          <hr>
          {% snippet 'snippets/package_list.html', packages=author_sets %}

        </div>
      </div>
    </div> {#} Card {#}
    {% endif %}

    {% if maintainer_sets %}
    <div class="card">
      <div class="card-header" role="tab" id="headingOne">
        <div class="row">
        <h3>
         <div class="col-sm-7 col-xs-7">
          <a data-toggle="collapse" href="#collapse3" aria-expanded="true" aria-controls="collapse3">
            {{ _('Maintainer') }}
              <i class="icon-angle-down pull-right"></i>
          </a>
         </div>
       </h3>
        </div>
      </div>
      <div id="collapse3" class="collapse" role="tabpanel" aria-labelledby="heading1" data-parent="#accordion">
        <div class="card-body">
          <hr>
          {% snippet 'snippets/package_list.html', packages=maintainer_sets %}

        </div>
      </div>
    </div> {#} Card {#}
    {% endif %}

  </div> {#} Accordeon {#}

{% endif %}

{% endblock %}
